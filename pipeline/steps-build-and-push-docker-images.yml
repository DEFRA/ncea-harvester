steps:

- task: Docker@2
  displayName: 'Docker Build'
  inputs:
    command: build
    containerRegistry: $(ACR.ServiceConnection)
    repository: $(ACR.ContainerRepository)
    tags: $(Build.BuildId)

- task: Docker@2
  displayName: 'Docker Push'
  condition: |
    or(
        and(and(succeeded(), eq(variables.isMaster, false)), eq(variables.isPullRequest, false)),
        and(succeeded(), eq(variables.isMaster, true))
      )  
  inputs:
    command: push
    containerRegistry: $(ACR.ServiceConnection)
    repository: $(ACR.ContainerRepository)
    tags: $(Build.BuildId)
