variables:
  - name : isMain
    value: $[eq(variables['Build.SourceBranch'], 'refs/heads/main')]
  - name : isPullRequest
    value: $[eq(variables['Build.Reason'], 'PullRequest')]
  - ${{ if eq(variables.isPullRequest, true) }}:
    - name : branchSource
      value: $(System.PullRequest.SourceBranch)
  - ${{ else }}:
    - name : branchSource
      value: $[replace(variables['Build.SourceBranch'], 'refs/heads/', ''
  - name : branch
    value: $[replace(variables['branchSource'], '/', '-')]
  - ${{ if eq(variables.isMain, false) }}:
    - name : artifactNameSuffix
      value: _$(branch)
  - ${{ else }}:
    - name : artifactNameSuffix
      value: ''
  - name : chartPath
    value: 'src/ncea-harvester/ncea-harvester'
  - name : imageTag
    value: $(Build.BuildNumber)$(artifactNameSuffix)