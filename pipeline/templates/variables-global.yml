variables:
  - name : isMain
    value: $[eq(variables['Build.SourceBranch'], 'refs/heads/main')]
  - name : isPullRequest
    value: $[eq(variables['Build.Reason'], 'PullRequest')]

  - ${{ if startsWith(variables['Build.SourceBranch'], 'refs/heads/features/') }}:
    - name : branchName
      value: $[ replace(variables['Build.SourceBranch'], 'refs/heads/', '') ]
  - ${{ if startsWith(variables['Build.SourceBranch'], 'refs/heads/releases/') }}:
    - name : branchName
      value: $[ replace(variables['Build.SourceBranch'], 'refs/heads/', '') ]
  - ${{ if startsWith(variables['Build.SourceBranch'], 'refs/pull/') }}:
    - name : branchName
      value: $[ replace(variables['System.PullRequest.SourceBranch'], 'refs/heads/', '') ]
  - ${{ if eq(variables['Build.SourceBranch'], 'refs/heads/master') }}:
    - name : branchName
      value: 'master'
  
  - name : branch
    value: $[replace(variables['branchName'], '/', '-')]

  # - ${{ if eq(variables.isMain, 'false') }}:
  #   - name : artifactNameSuffix
  #     value: _$(branch)
  # - ${{ else }}:
  #   - name : artifactNameSuffix
  #     value: _$(branch)

  - name : chartPath
    value: 'src/ncea-harvester/ncea-harvester'
  - name : imageTag
    value: $(Build.BuildNumber)_$[variables['branch']]